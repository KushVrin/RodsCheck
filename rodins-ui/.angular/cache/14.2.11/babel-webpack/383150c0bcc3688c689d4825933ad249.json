{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport { decode } from 'base64-arraybuffer';\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./app.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/material/progress-spinner\";\nconst _c0 = [\"FileSelectInputDialog\"];\n\nconst _c1 = function (a0) {\n  return {\n    \"is-dragging\": a0\n  };\n};\n\nfunction AppComponent_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵlistener(\"dragleave\", function AppComponent_ng_container_5_Template_div_dragleave_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.onDragLeave($event));\n    })(\"dragover\", function AppComponent_ng_container_5_Template_div_dragover_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.onDragOver($event));\n    })(\"drop\", function AppComponent_ng_container_5_Template_div_drop_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onDrop($event));\n    });\n    i0.ɵɵelementStart(2, \"span\", 6);\n    i0.ɵɵtext(3, \"Drag File Here\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 6);\n    i0.ɵɵtext(5, \"or\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 7)(7, \"input\", 8, 9);\n    i0.ɵɵlistener(\"change\", function AppComponent_ng_container_5_Template_input_change_7_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.onFileChange($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function AppComponent_ng_container_5_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.chooseFile());\n    });\n    i0.ɵɵtext(10, \"Choose file\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(1, _c1, ctx_r0.isDragging));\n  }\n}\n\nfunction AppComponent_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 11)(2, \"h3\")(3, \"i\", 12);\n    i0.ɵɵlistener(\"click\", function AppComponent_ng_container_6_Template_i_click_3_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.pageIndex = 0);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 13)(5, \"h3\");\n    i0.ɵɵtext(6, \"Source to destination file has been mapped and download link is generated.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"br\");\n    i0.ɵɵelementStart(8, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function AppComponent_ng_container_6_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.downloadFile());\n    });\n    i0.ɵɵtext(9, \"Click here download file\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"br\")(11, \"br\");\n    i0.ɵɵelementStart(12, \"div\", 14);\n    i0.ɵɵlistener(\"click\", function AppComponent_ng_container_6_Template_div_click_12_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.resetAll());\n    });\n    i0.ɵɵtext(13, \"Start Again\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction AppComponent_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 15)(2, \"p\")(3, \"strong\");\n    i0.ɵɵtext(4, \"Processing!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6, \" This might take a few minutes.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"mat-spinner\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(appService) {\n      this.appService = appService;\n      this.title = 'rodins';\n      this.isDragging = false;\n      this.pageIndex = 0;\n      this.isLoading = false;\n      this.uid = null;\n      this.downloadLink = null;\n      this.downloadFileName = '';\n      this.loadingMessage = \"\";\n      this.config = {\n        displayKey: 'name',\n        search: true,\n        height: '300px',\n        searchPlaceholder: 'Select an option',\n        placeholder: 'Search and select',\n        noResultsFound: 'No result found',\n        multiple: false,\n        disabled: false,\n        filterBlankData: true,\n        showSelectedAtDropdown: false,\n        theme: {\n          inputColor: '#288eca',\n          containerListBackground: '#f8f8f8',\n          ContainerListColor: '#288eca',\n          selectedItemColor: '#fff',\n          selectedItemBackground: '#288eca',\n          listHoverBackground: '#288eca',\n          listHoverColor: '#fff',\n          searchInputColor: '#000'\n        }\n      };\n      this.selectedOption = [];\n      this.options = [];\n    }\n\n    onDragOver(e) {\n      e.preventDefault();\n      this.isDragging = true;\n    }\n\n    onDragLeave(e) {\n      e.preventDefault();\n      this.isDragging = false;\n    }\n\n    onDrop(e) {\n      e.preventDefault();\n      this.isDragging = false;\n\n      if (e.dataTransfer.items) {\n        if (e.dataTransfer.items.length > 1) {\n          return;\n        }\n\n        const item = e.dataTransfer.items[0];\n\n        if (item.kind === 'file') {\n          const file = item.getAsFile();\n          this.sendFile(file);\n        }\n      }\n    }\n\n    chooseFile() {\n      if (this.FileSelectInputDialog) {\n        this.FileSelectInputDialog.nativeElement.click();\n      }\n    }\n\n    onFileChange(event) {\n      if (event.target.files.length > 0) {\n        this.sendFile(event.target.files[0]);\n      }\n    }\n\n    sendFile(file) {\n      let formdata = new FormData();\n      formdata.append('file', file);\n      this.loadingMessage = \"Proccessing!\\n This might take a while.\";\n      this.isLoading = true;\n      this.appService.processZip(formdata).subscribe(res => {\n        const blob = new Blob([res.body], {\n          type: res.headers.get('Content-Type')\n        });\n        this.downloadLink = window.URL.createObjectURL(blob);\n        this.downloadFileName = file.name.split(\".\")[0] + \"_extract_\" + this.getTime() + \".zip\";\n        this.loadingMessage = \"\";\n        this.isLoading = false;\n        this.pageIndex = 1;\n      });\n    }\n\n    sendSelectedOptions() {\n      if (this.selectedOption && !Array.isArray(this.selectedOption)) {\n        this.isLoading = true;\n        this.appService.getFile({\n          unzipFilePath: this.uid,\n          choice: this.selectedOption['name']\n        }).subscribe(res => {\n          if (res['content']) {\n            let buffer = decode(res['content']);\n            let file = new File([buffer], res['fileName']);\n            this.downloadLink = window.URL.createObjectURL(file);\n            this.downloadFileName = res['fileName'];\n          } else {\n            alert(res['message']);\n          }\n\n          this.isLoading = false;\n          this.pageIndex = 2;\n        });\n      } else {\n        alert('Select option first');\n      }\n    }\n\n    downloadFile() {\n      if (this.downloadLink) {\n        const downloadAncher = document.createElement('a');\n        downloadAncher.style.display = 'none';\n        downloadAncher.href = this.downloadLink;\n        downloadAncher.download = this.downloadFileName;\n        downloadAncher.click();\n      }\n    }\n\n    resetAll() {\n      this.pageIndex = 0;\n      this.selectedOption = [];\n      this.downloadLink = null;\n      this.downloadFileName = '';\n      this.uid = null;\n      this.options = [];\n    }\n\n    getTime() {\n      return moment().format(\"YMDHms\");\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.AppService));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    viewQuery: function AppComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.FileSelectInputDialog = _t.first);\n      }\n    },\n    decls: 8,\n    vars: 3,\n    consts: [[1, \"header\"], [1, \"brand\"], [1, \"main-content\"], [1, \"box\"], [4, \"ngIf\"], [1, \"dropzone\", 3, \"ngClass\", \"dragleave\", \"dragover\", \"drop\"], [1, \"text\"], [1, \"choose-file\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"change\"], [\"FileSelectInputDialog\", \"\"], [1, \"btn\", 3, \"click\"], [1, \"download-section\"], [1, \"ti\", \"ti-circle-arrow-left\", \"back-btn\", 3, \"click\"], [1, \"center\"], [1, \"link\", 3, \"click\"], [1, \"loader\"], [\"diameter\", \"30\", \"color\", \"#ff0000\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"span\", 1);\n        i0.ɵɵtext(2, \"Rodins Source To Destination Mapping Generator\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3);\n        i0.ɵɵtemplate(5, AppComponent_ng_container_5_Template, 11, 3, \"ng-container\", 4);\n        i0.ɵɵtemplate(6, AppComponent_ng_container_6_Template, 14, 0, \"ng-container\", 4);\n        i0.ɵɵtemplate(7, AppComponent_ng_container_7_Template, 8, 0, \"ng-container\", 4);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.pageIndex == 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.pageIndex == 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n      }\n    },\n    dependencies: [i2.NgClass, i2.NgIf, i3.MatSpinner],\n    styles: [\"*[_ngcontent-%COMP%]{font-family:Raleway,sans-serif}.header[_ngcontent-%COMP%]{position:fixed;left:0;right:0;padding:16px;background-color:#fff;box-shadow:0 8px 8px #0000001a}.header[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{color:#288eca;font-size:18px;font-weight:600}.main-content[_ngcontent-%COMP%]{width:100%;height:95vh;display:flex;justify-content:center;align-items:center}.main-content[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]{width:40%;height:70%;margin-top:5%;background-color:#fff;box-shadow:0 0 20px #0000001a;border-radius:10px;position:relative}.dropzone[_ngcontent-%COMP%]{border:2px dashed #cfcfcf;width:calc(100% - 35px);height:calc(100% - 30px);margin:15px;display:flex;flex-direction:column;text-align:center;justify-content:center}.dropzone.is-dragging[_ngcontent-%COMP%]{border-color:#288eca}.dropzone[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-weight:600;color:#707379;margin-bottom:10px;font-size:18px}.btn[_ngcontent-%COMP%]{padding:8px 16px;background-color:#288eca;border:none;border-radius:3px;color:#fff;cursor:pointer}.options-section[_ngcontent-%COMP%]{padding:20px}.options-section[_ngcontent-%COMP%]   mat-select[_ngcontent-%COMP%]{width:100%;height:20px}.options-section[_ngcontent-%COMP%]   .center[_ngcontent-%COMP%]{text-align:center;margin:auto}.options-section[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{font-size:13px;height:40px;width:60%;margin:10% auto auto}.back-btn[_ngcontent-%COMP%]{color:#707379;font-size:23px;margin-right:10px;vertical-align:middle;cursor:pointer}.download-section[_ngcontent-%COMP%]{padding:20px}.download-section[_ngcontent-%COMP%]   .center[_ngcontent-%COMP%]{margin:10% auto auto;width:80%;text-align:center}.loader[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center}.loader[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loader[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:15px}[_nghost-%COMP%]     .all-items{text-align:left}[_nghost-%COMP%]     .mat-spinner{margin:auto}[_nghost-%COMP%]     .mat-spinner, [_nghost-%COMP%]     circle{stroke:#288eca}.link[_ngcontent-%COMP%]{color:#288eca;text-decoration:underline;font-size:12px;font-weight:600;cursor:pointer}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}